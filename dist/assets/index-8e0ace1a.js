var m=Object.defineProperty;var _=(c,e,t)=>e in c?m(c,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):c[e]=t;var d=(c,e,t)=>(_(c,typeof e!="symbol"?e+"":e,t),t);import{d as h,u as w,c as f,a as k,t as S,b as I,e as P,f as x,F as B,E as D,o as q,_ as j}from"./index-d784623d.js";class b{constructor(e){d(this,"dbName");d(this,"db");this.dbName=e}openStore(e,t,l){const s=window.indexedDB.open(this.dbName,1);return new Promise((r,n)=>{s.onsuccess=o=>{console.log("数据库打开成功"),this.db=o.target.result,console.log(o),r(!0)},s.onerror=o=>{console.log("数据库打开失败"),console.log(o),n(o)},s.onupgradeneeded=o=>{console.log("数据库升级成功");const{result:u}=o.target,g=u.createObjectStore(e,{autoIncrement:!0,keyPath:t});l&&l.length>0&&l.map(a=>{g.createIndex(a,a,{unique:!1})}),g.transaction.oncomplete=a=>{console.log("创建对象仓库成功"),console.log(a)}}})}updateItem(e,t){console.log(this.db);const s=this.db.transaction([e],"readwrite").objectStore(e).put({...t,updateTime:new Date().getTime()});return new Promise((r,n)=>{s.onsuccess=o=>{console.log("数据写入成功"),console.log(o),r(o)},s.onerror=o=>{console.log("数据库写入失败"),console.log(o),n(o)}})}deleteItem(e,t){console.log(this.db);const s=this.db.transaction([e],"readwrite").objectStore(e).delete(t);return new Promise((r,n)=>{s.onsuccess=o=>{console.log("数据删除成功"),console.log(o),r(o)},s.onerror=o=>{console.log("数据库删除失败"),console.log(o),n(o)}})}getList(e){const l=this.db.transaction(e).objectStore(e).getAll();return new Promise((s,r)=>{l.onsuccess=n=>{console.log("数据获取成功"),console.log(n.target.result),s(n.target.result)},l.onerror=n=>{console.log("数据库获取失败"),console.log(n.target.result),r(n.target.result)}})}getItem(e,t){console.log(this.db);const s=this.db.transaction(e).objectStore(e).get(t);return new Promise((r,n)=>{s.onsuccess=o=>{console.log("数据获取成功"),console.log(o.target.result),r(o.target.result)},s.onerror=o=>{console.log("数据库获取失败"),console.log(o.target.result),n(o.target.result)}})}}let i=new b("airbnb");async function y(){return await i.openStore("elephant","id",["nose","ear"]),await i.getList("elephant").then(e=>({code:"000000",message:"操作成功",result:e,success:!0}))}const p="",E=h({__name:"index",setup(c){let e=new b("airbnb");const t=()=>{e.updateItem("elephant",{nose:1,ear:2})},{t:l}=w();function s(){y().then(r=>{console.log(r)})}return e.openStore("elephant","id",["nose","ear"]),s(),(r,n)=>{const o=D;return q(),f(B,null,[k(S(I(l)("message.home"))+" ",1),P(o,{modelValue:p,"onUpdate:modelValue":n[0]||(n[0]=u=>p=u),type:"week",format:"[Week] ww",placeholder:"Pick a week"}),x("button",{onClick:t},"add")],64)}}});const C=j(E,[["__scopeId","data-v-26c88d98"]]);export{C as default};
